---
import BaseLayout from '../layouts/BaseLayout.astro';
import ToolCard from '../components/ToolCard.astro';
import { getAllToolsLocalized } from '../lib/data';
import { t, localePath, type Locale } from '../lib/i18n';

interface Props { lang: Locale }
const { lang } = Astro.props;

const allTools = getAllToolsLocalized(lang);
const tools = allTools.filter(tool => {
  const ideBase = ((tool as any).features?.ide_base || '').toLowerCase();
  return tool.type === 'cli' || ideBase.includes('ç»ˆç«¯') || ideBase.includes('tui') || ideBase.includes('cli');
}).sort((a, b) => (b.scores.coding_ability ?? 0) - (a.scores.coding_ability ?? 0));

const siteUrl = 'https://codepick.dev';
const pagePath = localePath('/tools/terminal', lang);

const jsonLd = {
  '@context': 'https://schema.org',
  '@type': 'ItemList',
  name: lang === 'zh' ? 'ç»ˆç«¯ AI ç¼–ç¨‹å·¥å…·' : 'Terminal AI Coding Tools',
  url: `${siteUrl}${pagePath}`,
  numberOfItems: tools.length,
  itemListElement: tools.map((tool, i) => ({
    '@type': 'ListItem',
    position: i + 1,
    name: tool.name,
    url: `${siteUrl}${localePath(`/tool/${tool.id}`, lang)}`,
  })),
};

const breadcrumb = {
  '@context': 'https://schema.org',
  '@type': 'BreadcrumbList',
  itemListElement: [
    { '@type': 'ListItem', position: 1, name: t('bread.home', lang), item: siteUrl },
    { '@type': 'ListItem', position: 2, name: t('bread.toolLibrary', lang), item: `${siteUrl}${localePath('/tools', lang)}` },
    { '@type': 'ListItem', position: 3, name: t('bread.terminal', lang), item: `${siteUrl}${pagePath}` },
  ],
};

const seoTitle = lang === 'zh' ? 'ç»ˆç«¯ AI ç¼–ç¨‹å·¥å…· | CLI | CodePick' : 'Terminal AI Coding Tools | CLI | CodePick';
const seoDesc = lang === 'zh'
  ? `${tools.length} æ¬¾ç»ˆç«¯/CLI AI ç¼–ç¨‹å·¥å…·ï¼šClaude Codeã€OpenCodeã€Aiderã€‚é€‚åˆ Vim ç”¨æˆ·ã€ç»ˆç«¯å…šï¼Œæ”¯æŒä»»æ„ç¼–è¾‘å™¨å·¥ä½œæµã€‚`
  : `${tools.length} terminal/CLI AI coding tools: Claude Code, OpenCode, Aider. For Vim users and terminal workflows.`;
---

<BaseLayout title={seoTitle} description={seoDesc} jsonLd={[jsonLd, breadcrumb]} lang={lang}>
  <section class="container py-12">
    <nav class="text-xs text-[var(--text-muted)] mb-6">
      <a href={localePath('/', lang)} class="hover:text-white no-underline">{t('bread.home', lang)}</a>
      <span class="mx-1">/</span>
      <a href={localePath('/tools', lang)} class="hover:text-white no-underline">{t('bread.toolLibrary', lang)}</a>
      <span class="mx-1">/</span>
      <span class="text-[var(--text-secondary)]">{t('bread.terminal', lang)}</span>
    </nav>

    <h1 class="text-3xl font-bold text-white mb-3">{t('term.title', lang)}</h1>
    <p class="text-[var(--text-secondary)] mb-4 max-w-2xl">
      {t('term.subtitle1', lang)}
      {tools.length} {t('term.subtitle2', lang)}
    </p>

    <div class="card p-4 mb-8 border-l-4 border-[var(--brand-400)]">
      <p class="text-sm text-[var(--text-secondary)] m-0">
        ğŸ’¡ <strong class="text-white">{t('term.advTitle', lang)}</strong>ï¼š{t('term.advDesc', lang)}
      </p>
    </div>

    <div class="flex flex-wrap gap-2 mb-8">
      <a href={localePath('/tools', lang)} class="btn btn-ghost text-sm no-underline">{t('cat.all', lang)}</a>
      <a href={localePath('/tools/free', lang)} class="btn btn-ghost text-sm no-underline">{t('cat.free', lang)}</a>
      <a href={localePath('/tools/china', lang)} class="btn btn-ghost text-sm no-underline">{t('cat.china', lang)}</a>
      <a href={localePath('/tools/vscode', lang)} class="btn btn-ghost text-sm no-underline">{t('cat.vscode', lang)}</a>
      <span class="btn btn-primary text-sm cursor-default">{t('cat.terminal', lang)}</span>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
      {tools.map(tool => <ToolCard tool={tool} lang={lang} />)}
    </div>

    <div class="mt-12 grid grid-cols-1 md:grid-cols-2 gap-4">
      <a href={localePath('/compare/terminal-ai-tools', lang)} class="card p-5 no-underline group block">
        <h3 class="text-sm font-semibold text-white group-hover:text-[var(--brand-400)] m-0 mb-1">{t('term.relCompare', lang)}</h3>
        <p class="text-xs text-[var(--text-muted)] m-0">{t('term.relCompareDesc', lang)}</p>
      </a>
      <a href={localePath('/guides/ollama-aider-local', lang)} class="card p-5 no-underline group block">
        <h3 class="text-sm font-semibold text-white group-hover:text-[var(--brand-400)] m-0 mb-1">{t('term.relOllama', lang)}</h3>
        <p class="text-xs text-[var(--text-muted)] m-0">{t('term.relOllamaDesc', lang)}</p>
      </a>
    </div>
  </section>
</BaseLayout>
