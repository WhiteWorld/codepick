---
import ScoreBar from './ScoreBar.astro';
import { t, localePath, type Locale } from '../lib/i18n';

interface Props {
  tool: any;
  lang?: Locale;
}
const { tool, lang = 'zh' } = Astro.props;

const meta = tool.meta || {};
const scores = tool.scores || {};
---

<a href={localePath(`/tool/${tool.id}`, lang)} class="card p-5 no-underline group block">
  <div class="flex items-center gap-3 mb-3">
    <div class="w-10 h-10 rounded-lg bg-[var(--surface-hover)] flex items-center justify-center text-lg font-bold text-[var(--brand-400)]">
      {tool.name.charAt(0)}
    </div>
    <div>
      <h3 class="text-base font-semibold text-white group-hover:text-[var(--brand-400)] m-0">{tool.name}</h3>
      <span class="tag text-xs">{t(`type.${tool.type}`, lang) || tool.type || t('type.tool', lang)}</span>
    </div>
  </div>
  <p class="text-xs text-[var(--text-muted)] mb-3 m-0">{tool.tagline || ''}</p>
  <div class="flex flex-col gap-1.5">
    <ScoreBar label={t('score.coding', lang)} score={scores.coding_ability ?? 5} color="auto" />
    <ScoreBar label={t('score.costEfficiency', lang)} score={scores.cost_efficiency ?? 5} color="auto" />
    <ScoreBar label={t('score.flexibility', lang)} score={scores.flexibility ?? 5} color="auto" />
    <ScoreBar label={t('score.china', lang)} score={scores.china_friendly ?? 5} color="auto" />
  </div>
  {(meta.last_verified || meta.confidence) && (
    <div class="mt-3 text-xs text-[var(--text-muted)]">
      {meta.last_verified && <span>{t('meta.verified', lang)} {meta.last_verified}</span>}
      {meta.last_verified && meta.confidence && <span> Â· </span>}
      {meta.confidence && <span>{t('meta.shortConf', lang)} {meta.confidence}</span>}
    </div>
  )}
</a>
